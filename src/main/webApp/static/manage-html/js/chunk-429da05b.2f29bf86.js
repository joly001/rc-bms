(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-429da05b"],{bbf3:function(e,t,i){},c147:function(e,t,i){"use strict";var r=i("bbf3"),a=i.n(r);a.a},e3fb:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-tree",{ref:"tree",attrs:{data:e.orgList,"show-checkbox":"",props:e.defaultProps,"node-key":"id","default-expanded-keys":e.expandedKeys,"check-strictly":!0,"highlight-current":!0,"default-expand-all":"","expand-on-click-node":!1},on:{"check-change":e.checkChange,"node-click":e.nodeClick}}),i("div",{staticClass:"table-box"},[i("el-input",{staticClass:"mr10",attrs:{placeholder:"请输入：姓名/手环编号/手机号"},nativeOn:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.table.query.currentPage=1,e.getData()}},model:{value:e.table.query.condition.condition,callback:function(t){e.$set(e.table.query.condition,"condition",t)},expression:"table.query.condition.condition"}}),i("div",{staticClass:"btn-main ",on:{click:function(t){e.table.query.currentPage=1,e.getData()}}},[e._v("查   询")]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.table.query.condition.organizationId,expression:"table.query.condition.organizationId"}],staticClass:"btn-main btn-add",on:{click:function(t){return e.showDialog("add")}}},[e._v("新建人员信息")]),i("table",{staticClass:"table",attrs:{cellspacing:"0"}},[e._m(0),e._l(e.table.list,(function(t,r){return i("tr",[i("td",[e._v(e._s(r+1+(e.table.query.currentPage-1)*e.table.query.pageSize))]),i("td",[e._v(e._s(t.nick))]),i("td",[e._v(e._s(t.wristStrapCode))]),i("td",[e._v(e._s(e._f("userType")(t.builderUserType)))]),i("td",[e._v(e._s(t.mobile))]),i("td",[e._v(e._s("00"===t.builderStatus?"入场":"离场"))]),i("td",[e._v(e._s(new Date(t.admissionDate).$Format("yyyy-MM-dd")))]),i("td",[i("span",{staticClass:"oper",on:{click:function(i){return e.showDialog("edit",t)}}},[e._v("修改")]),i("span",{staticClass:"col"}),i("span",{staticClass:"oper",on:{click:function(i){return e.remove(t)}}},[e._v("删除")])])])})),i("no-data",{directives:[{name:"show",rawName:"v-show",value:!e.table.list.length,expression:"!table.list.length"}]})],2),i("el-pagination",{staticClass:"pagination",attrs:{"page-size":e.table.query.pageSize,layout:"prev, pager, next, jumper",total:e.table.total},on:{"current-change":e.handleCurrentChange}})],1),i("el-dialog",{staticClass:"dialog",attrs:{modal:!1,center:"","close-on-click-modal":!1,title:e.title,visible:e.dialog,width:"380px"},on:{"update:visible":function(t){e.dialog=t}}},[i("el-form",{ref:"form",staticClass:"form",attrs:{"label-width":"70px","label-position":"left"}},[i("el-form-item",{attrs:{label:"部门"}},[i("el-input",{attrs:{disabled:"",value:e.checkName}})],1),i("el-form-item",{attrs:{label:"姓名"}},[i("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.user.query.nick,callback:function(t){e.$set(e.user.query,"nick",t)},expression:"user.query.nick"}})],1),i("el-form-item",{attrs:{prop:"oldPassword",label:"手环编号"}},[i("el-input",{attrs:{placeholder:"请输入手环编号"},model:{value:e.user.query.wristStrapCode,callback:function(t){e.$set(e.user.query,"wristStrapCode",t)},expression:"user.query.wristStrapCode"}})],1),i("el-form-item",{attrs:{prop:"oldPassword",label:"职位"}},[i("el-select",{attrs:{placeholder:"请选择职位"},model:{value:e.user.query.builderUserType,callback:function(t){e.$set(e.user.query,"builderUserType",t)},expression:"user.query.builderUserType"}},e._l(e.options,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"角色"}},[i("div",{staticClass:"btn-set",on:{click:e.showRoleDialog}},[e._v("\n          "+e._s(e.roleName||"选择角色")+"\n        ")])]),i("el-form-item",{attrs:{prop:"oldPassword",label:"手机号"}},[i("el-input",{attrs:{type:"number",placeholder:"请输入手机号"},model:{value:e.user.query.mobile,callback:function(t){e.$set(e.user.query,"mobile",t)},expression:"user.query.mobile"}})],1),i("el-form-item",{attrs:{prop:"oldPassword",label:"状态"}},[i("el-radio-group",{model:{value:e.user.query.builderStatus,callback:function(t){e.$set(e.user.query,"builderStatus",t)},expression:"user.query.builderStatus"}},[i("el-radio",{staticClass:"mr20",attrs:{label:"00"}},[e._v("入场")]),i("el-radio",{staticClass:"ml20",attrs:{label:"01"}},[e._v("离场")])],1)],1),i("el-form-item",{attrs:{prop:"oldPassword",label:"入场时间"}},[i("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.user.query.admissionLeaveDate,callback:function(t){e.$set(e.user.query,"admissionLeaveDate",t)},expression:"user.query.admissionLeaveDate"}})],1)],1),i("div",{staticClass:"btns mt25"},[i("div",{staticClass:"btn-main mr15",on:{click:function(t){return e.addEdit()}}},[e._v("提交")]),i("div",{staticClass:"btn-main",on:{click:function(t){e.dialog=!1}}},[e._v("关闭")])])],1),i("el-dialog",{staticClass:"dialog",attrs:{modal:!1,center:"","close-on-click-modal":!1,title:"选择角色",visible:e.roleDialog,width:"800px"},on:{"update:visible":function(t){e.roleDialog=t}}},[e.roleDialog?i("table",{staticClass:"table role-table",attrs:{cellspacing:"0"}},[i("tr",[i("th",{attrs:{width:"10%"}},[e._v("选择")]),i("th",{attrs:{width:"10%"}},[e._v("序号")]),i("th",{attrs:{width:"20%"}},[e._v("角色名称")]),i("th",{attrs:{width:"45%"}},[e._v("角色描述")]),i("th",{attrs:{width:"15%"}},[e._v("类型")])]),e._l(e.roleList.list,(function(t,r){return i("tr",[i("td",[i("el-checkbox",{on:{change:function(i){return e.changeBox(t)}},model:{value:t.selected,callback:function(i){e.$set(t,"selected",i)},expression:"item.selected"}})],1),i("td",[e._v(e._s(r+1+(e.roleList.query.currentPage-1)*e.roleList.query.pageSize))]),i("td",[e._v(e._s(t.roleName))]),i("td",[e._v(e._s(t.roleDesc))]),i("td",[e._v(e._s("00"===t.roleType?"默认":"自定义"))])])})),i("no-data",{directives:[{name:"show",rawName:"v-show",value:!e.table.list.length,expression:"!table.list.length"}]})],2):e._e(),i("el-pagination",{staticClass:"pagination",attrs:{"page-size":e.roleList.query.pageSize,layout:"prev, pager, next, jumper",total:e.roleList.total},on:{"current-change":e.handleRoleListCurrentChange}}),i("div",{staticClass:"btns"},[i("div",{staticClass:"btn-main mr15",on:{click:e.selectedRole}},[e._v("提交")]),i("div",{staticClass:"btn-main",on:{click:function(t){e.roleDialog=!1}}},[e._v("关闭")])])],1)],1)},a=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("tr",[i("th",{attrs:{width:"8%"}},[e._v("序号")]),i("th",{attrs:{width:"10%"}},[e._v("姓名")]),i("th",{attrs:{width:"16%"}},[e._v("手环编号")]),i("th",{attrs:{width:"14%"}},[e._v("职位")]),i("th",{attrs:{width:"15%"}},[e._v("手机号")]),i("th",{attrs:{width:"9%"}},[e._v("状态")]),i("th",{attrs:{width:"14%"}},[e._v("入/离职时间")]),i("th",{attrs:{width:"14%"}},[e._v("操作")])])}],s=(i("11ac"),i("f763"),i("7a59"),i("63ff"),i("cec5")),n=[{value:"00",label:"机车"},{value:"01",label:"列车"},{value:"02",label:"作业人员"},{value:"03",label:"作业负责人"},{value:"04",label:"安全员"},{value:"05",label:"防护员"},{value:"06",label:"监理"},{value:"07",label:"其它人员"}],l={name:"Info",data:function(){return{roleDialog:!1,title:"新建人员信息",table:{url:"/user/list",loading:".table",list:[],el:"table",total:0,query:{currentPage:1,pageSize:this.$conf.PAGES,condition:{nick:null,mobile:null,wristStrapCode:null,organizationId:null}}},user:{url:"/user/add",query:{nick:"",mobile:"",roleId:"",builderUserType:"00",builderStatus:"00",admissionLeaveDate:null,wristStrapCode:"",organizationId:""}},roleList:{url:"/role/list",list:[],total:0,query:{currentPage:1,pageSize:this.$conf.PAGES,condition:{}}},roleName:"",dialog:!1,orgList:[],options:n,defaultProps:{children:"childOrgList",label:"orgName"},expandedKeys:[],editCheckId:null}},mounted:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getOrgList();case 2:return e.next=4,this.getData();case 4:this.getRoleList();case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),computed:{checkName:function(){var e=this,t="";function i(r){r.forEach((function(r){r.id===e.editCheckId?t=r.orgName:i(r.childOrgList)}))}return i(this.orgList),this.orgList.length?t||this.orgList[0].orgName:t}},methods:{selectedRole:function(){for(var e=0;e<this.roleList.list.length;e++)if(this.roleList.list[e].selected){this.user.query.roleId=this.roleList.list[e].id,this.roleName=this.roleList.list[e].roleName,this.roleList.list[e].selected=!1;break}this.roleDialog=!1},changeBox:function(e){this.roleList.list.forEach((function(t){t.id===e.id&&!0===t.selected?t.selected=!0:t.selected=!1})),this.roleList.list=this.roleList.list.splice(0,this.roleList.list.length)},getRoleList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax(this.roleList);case 2:t=e.sent,this.roleList.list=t.pageItems||[],this.roleList.total=t.totalCount,this.roleList.list.forEach((function(e){e.selected=!1}));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleCurrentChange:function(e){this.table.query.currentPage=e,this.getData()},handleRoleListCurrentChange:function(e){this.roleList.query.currentPage=e,this.getRoleList()},showDialog:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,i){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.dialog=!0,"add"!==t){e.next=6;break}this.title="新建人员信息",this.user.query={nick:"",mobile:"",roleId:"",builderUserType:"00",builderStatus:"00",admissionLeaveDate:null,wristStrapCode:"",organizationId:""},e.next=12;break;case 6:return this.title="修改人员信息",e.next=9,this.$ajax({url:"/user/details",query:{id:i.id}});case 9:r=e.sent,this.roleName=r.roleName,this.user.query={nick:r.nick,mobile:r.mobile,roleId:r.roleId,builderUserType:r.builderUserType,builderStatus:r.builderStatus,admissionLeaveDate:new Date(r.admissionDate),wristStrapCode:r.wristStrapCode,organizationId:r.organizationId,id:i.id};case 12:case"end":return e.stop()}}),e,this)})));function t(t,i){return e.apply(this,arguments)}return t}(),getData:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax(this.table);case 2:t=e.sent,this.table.list=t.pageItems||[],this.table.total=t.totalCount;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),remove:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("数据删除后将不能恢复，请确认是否删除！","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"});case 2:return e.next=4,this.$ajax({url:"/user/delete",query:{id:t.id}});case 4:this.$remind("删除成功"),this.getData();case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),getOrgList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax({url:"/organization/all"});case 2:t=e.sent,this.orgList=t.childOrgList,this.expandedKeys=this.orgList.map((function(e){return e.id})),setTimeout((function(){for(var e=document.getElementsByClassName("el-tree-node__label"),t=0;t<e.length;t++)console.log(e[t].innerText),e[t].setAttribute("title",e[t].innerText)}),10);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),showRoleDialog:function(){this.roleDialog=!0},addEdit:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t="","新建人员信息"===this.title?(t="新建成功",this.roleName="",this.user.url="/user/add",this.user.query.organizationId=this.editCheckId):(t="修改成功",this.user.url="/user/update"),i=JSON.parse(JSON.stringify(this.user)),i.query.admissionLeaveDate=new Date(i.query.admissionLeaveDate).$Format("yyyy-MM-dd"),e.next=6,this.$ajax(i);case 6:this.getData(),this.$remind(t),this.dialog=!1;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),checkChange:function(e,t,i){1==t?(this.editCheckId=e.id,this.$refs.tree.setCheckedKeys([e.id]),this.table.query.condition.organizationId=e.id):this.editCheckId==e.id&&(this.$refs.tree.setCheckedKeys([e.id]),this.table.query.condition.organizationId=e.id),this.getData()},nodeClick:function(e,t,i){this.editCheckId=e.id,this.$refs.tree.setCheckedKeys([e.id])}},filters:{userType:function(e){for(var t=0;t<n.length;t++)if(e===n[t].value)return n[t].label}}},o=l,u=(i("c147"),i("6691")),c=Object(u["a"])(o,r,a,!1,null,"6f590755",null);t["default"]=c.exports}}]);
//# sourceMappingURL=chunk-429da05b.2f29bf86.js.map